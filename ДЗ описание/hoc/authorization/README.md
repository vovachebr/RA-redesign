# HOC для контроля доступа

## Цель задачи  
Создать компонент высшего порядка (HOC) `withAuthorization`, который ограничивает доступ к оборачиваемому компоненту на основе ролей текущего пользователя. HOC должен проверять, есть ли у пользователя необходимые права, и в зависимости от этого либо рендерить исходный компонент, либо показывать заглушку с сообщением об отсутствии доступа.

---

## Функциональные требования

1. **Интерфейс HOC**  
   HOC `withAuthorization` должен принимать два параметра:  
   - `WrappedComponent` — React-компонент, который нужно защитить.  
   - `allowedRoles` — массив строк, задающий список ролей, которым разрешён доступ к компоненту.

2. **Передача информации о пользователе**  
   В отличие от реализации с использованием React Context, данные о текущем пользователе (в частности, его роли) должны передаваться в HOC через пропсы.  

   Рекомендуется, чтобы HOC ожидал в своих пропсах объект `currentUser` с полем `roles` — массивом ролей пользователя, например:  
   ```js
   {
     currentUser: {
       roles: ['admin', 'user']
     }
   }
   ```

3. **Логика проверки доступа**  
   - Если у текущего пользователя есть хотя бы одна роль из списка `allowedRoles`, HOC должен отрендерить `WrappedComponent` с исходными пропсами (включая `currentUser`).  
   - Если у пользователя нет нужной роли или `currentUser` отсутствует, HOC должен отрендерить компонент-заглушку `AccessDenied`, который отображает сообщение:  
     > "У вас нет прав для просмотра этого раздела."

4. **Поведение при отсутствии данных о пользователе**  
   - Если пропс `currentUser` отсутствует или равен `null`/`undefined`, считать, что пользователь не авторизован, и показывать заглушку.

5. **Передача пропсов**  
   - Все пропсы, которые получает HOC, должны быть переданы внутрь `WrappedComponent` без изменений (если доступ разрешён).

6. **Типизация (опционально)**  
   - Если используется TypeScript, типы пропсов должны корректно передаваться через HOC.

---

## Нефункциональные требования

- HOC должен быть реализован как функциональный компонент с использованием React Hooks (если необходимо).  
- Не должно быть побочных эффектов, влияющих на другие части приложения.  
- Код должен быть читаемым и документированным.  
- Рендеринг должен быть оптимизирован: не должно происходить лишних перерендеров при неизменных пропсах и ролях.

---

## Дополнительные рекомендации

- Компонент `AccessDenied` можно реализовать отдельно, чтобы его можно было переиспользовать.  
- В качестве альтернативы заглушке можно предусмотреть возможность передачи кастомного компонента для отображения при отказе в доступе.  
- Можно добавить поддержку нескольких ролей пользователя (например, массив ролей в пропсах).  
- Тесты (unit) для HOC должны покрывать сценарии: доступ разрешён, доступ запрещён, данные пользователя отсутствуют.

---

## Пример использования

```jsx
function AccessDenied() {
  return <div>У вас нет прав для просмотра этого раздела.</div>;
}

// Пример защищённого компонента
function AdminPanel() {
  return <div>Админская панель</div>;
}

const AdminPanelWithAuth = withAuthorization(AdminPanel, ['admin']);

// Использование
// <AdminPanelWithAuth currentUser={{ roles: ['user'] }} />
```

### Структура проекта (пример)

```
src/
  hoc/
    withAuthorization.tsx      // реализация HOC
  components/
    AccessDenied.tsx   // компонент с сообщением об отказе в доступе
    AdminPanel.tsx   // пример компонента, защищённого HOC
  App.tsx
  types.ts   // содержит интерфейс CurrentUser
  index.tsx
```